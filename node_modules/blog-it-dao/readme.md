# blog-it-dao

[![Build Status](https://travis-ci.org/blog-it/blog-it-dao.svg?branch=master)](https://travis-ci.org/blog-it/blog-it-dao)

blog-it-doa is a [nodejs](http://nodejs.org/) module to create services in order to perform standard CRUD operation on a [mongodb](https://www.mongodb.org) collection.
The whole API returns promises

## Getting started

You will need a connected db instance. Then simply use the factory like this:

```javascript
//assuming you have a connected db in the 'db' variable
var daoFactory=require('blog-it-dao');
var service=daoFactory(db,'a collection');

//now you can use your service
service.findOne('id').then(function(item){

});
```

## API

Refer to the [mongodb nodejs driver documentation](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html) for further details. The main difference is that blog-it-dao API does not take a callback but return a promise
which will be resolve with the expected result or rejected with the error if any

```javascript
collection.findOne(selector, options, function(err, item){
    if(err){
        console.log(err);
        throw err;
    }
    //do something with the item
});
```
will be

```javascript
daoService.findOne(selector, options).then(function(item){
        //do something with the item
    },
    function(err){
        console.log(err);
    }
);
```
The supported method are

* [findOne](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#findOne)
* [find](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#find)
* [insert](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#insert)
* [remove](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#remove)
* [save](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#save)
* [update](http://mongodb.github.io/node-mongodb-native/api-generated/collection.html#update)

additionally, blog-it-dao expose some method "by id":

* findById(id, options): equivalent to findOne with selector ```{_id:id}```
* removeById(id, options): equivalent to remove with selector ```{_id:id}```
* updateById(id, options): equivalent to update with selector ```{_id:id}```

## running test

simply run ```npm test``` in a command shell

## Licence

> Copyright (C) 2014 Laurent Renard.
>
> Permission is hereby granted, free of charge, to any person
> obtaining a copy of this software and associated documentation files
> (the "Software"), to deal in the Software without restriction,
> including without limitation the rights to use, copy, modify, merge,
> publish, distribute, sublicense, and/or sell copies of the Software,
> and to permit persons to whom the Software is furnished to do so,
> subject to the following conditions:
>
> The above copyright notice and this permission notice shall be
> included in all copies or substantial portions of the Software.
>
> THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
> EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
> MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
> NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
> BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
> ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
> CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
> SOFTWARE.

